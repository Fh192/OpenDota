import{g as k}from"./matches.0b1bcd1c.js";import{a as I,A,b as H,c as B}from"./AppProgress.62139a32.js";import{d as $,_ as y,c as o,F as f,h as g,o as t,i as m,b as c,e as d,w as _,r as l,m as R,t as S,f as T,p as D,g as E,j as C,A as x,x as N}from"./index.dbb55856.js";import{H as P,d as w,e as j,a as F,A as L,b as O}from"./AppCaption.2b0a1b25.js";const V=$({name:"MatchesTableHeader",data(){return{columns:["ID","\u0414\u043B\u0438\u0442\u0435\u043B\u044C\u043D\u043E\u0441\u0442\u044C","Radiant","Dire"]}}});const q={class:"header-row"},U=["textContent"];function z(e,n,r,p,h,b){return t(),o("tr",q,[(t(!0),o(f,null,g(e.columns,a=>(t(),o("th",{key:a,textContent:m(a)},null,8,U))),128))])}const G=y(V,[["render",z],["__scopeId","data-v-7972b062"]]),J=$({name:"MatchesTableRowHeroes",props:{heroes:{type:Array,required:!0}}});const K={class:"heroes-list"},Q=["src","alt"];function W(e,n,r,p,h,b){return t(),o("ul",K,[(t(!0),o(f,null,g(e.heroes,a=>(t(),o("li",{class:"heroes-list__item",key:a.id},[c("img",{src:a.img,alt:a.name},null,8,Q)]))),128))])}const X=y(J,[["render",W],["__scopeId","data-v-ff5bd2b7"]]),Y=$({name:"MatchesTableRow",components:{AppProgress:I,AppTooltip:A,MatchesTableRowHeroes:X},props:{match:{type:Object,required:!0},isPublic:{type:Boolean,default:!1},team:{type:Object,default:null}},computed:{radiantHeroes(){if(!this.isPublic)return[];const{radiant_team:e}=this.match;return e.split(",").map(n=>{const r=P[n];return{...r,img:`${w}${r.img}`}})},direHeroes(){if(!this.isPublic)return[];const{dire_team:e}=this.match;return e.split(",").map(n=>{const r=P[n];return{...r,img:`${w}${r.img}`}})},duration(){return j(this.match.duration)},ended(){return F(this.match.start_time)},endedDate(){return new Intl.DateTimeFormat("ru",{dateStyle:"long"}).format(this.match.start_time*1e3)},teamName(){return this.team?this.team.name:""},teamLogo(){return this.team?this.team.logo_url:""},teamId(){return this.team?this.team.team_id:0},opposingTeamName(){return this.isPublic?"":this.match.opposing_team_name},opposingTeamLogo(){return this.isPublic?"":this.match.opposing_team_logo},opposingTeamId(){return this.isPublic?0:this.match.opposing_team_id},teams(){if(this.isPublic||!this.team)return[];const{opposing_team_id:e,opposing_team_logo:n,opposing_team_name:r,radiant:p}=this.match,{team_id:h,logo_url:b,name:a}=this.team,i=[],u={name:a,logo:b,id:h},s={name:r,logo:n,id:e};return p?(i[0]=u,i[1]=s):(i[0]=s,i[1]=u),i},teamsHeroes(){return[{id:"radiant",heroes:this.radiantHeroes},{id:"dire",heroes:this.direHeroes}]}}});const M=e=>(D("data-v-879edb9e"),e=e(),E(),e),Z={class:"table-row"},ee={class:"table-col"},te={class:"table-col__info"},ae=["textContent"],se=M(()=>c("span",{class:"table-col__info-separator"},"\xA0/\xA0",-1)),oe=M(()=>c("span",{textContent:"Immortal"},null,-1)),ne={class:"table-col"},re=["textContent"],ie={class:"table-col__team"},ce=["src","alt"];function le(e,n,r,p,h,b){const a=l("router-link"),i=l("app-tooltip"),u=l("matches-table-row-heroes");return t(),o("tr",Z,[c("td",ee,[d(a,{class:"table-col__link",to:`/matches/${e.match.match_id}`,textContent:m(e.match.match_id)},null,8,["to","textContent"]),c("div",te,[d(i,null,{activator:_(({on:s})=>[c("time",R(S(s,!0),{textContent:m(e.ended)}),null,16,ae)]),default:_(()=>[T(" "+m(e.endedDate),1)]),_:1}),se,oe])]),c("td",ne,[c("time",{datetime:"",textContent:m(e.duration)},null,8,re)]),e.isPublic?(t(!0),o(f,{key:0},g(e.teamsHeroes,({heroes:s,id:v})=>(t(),o("td",{class:"table-col",key:v},[d(u,{heroes:s},null,8,["heroes"])]))),128)):(t(!0),o(f,{key:1},g(e.teams,s=>(t(),o("td",{class:"table-col",key:s.id},[c("div",ie,[c("img",{class:"table-col__team-logo",src:s.logo,alt:s.name},null,8,ce),d(a,{class:"table-col__team-name",to:`/teams/${s.id}/matches`,textContent:m(s.name)},null,8,["to","textContent"])])]))),128))])}const ue=y(Y,[["render",le],["__scopeId","data-v-879edb9e"]]),me=$({name:"MatchesTable",components:{AppTable:L,MatchesTableHeader:G,MatchesTableRow:ue},props:{matches:{type:Array,required:!0,default:()=>[]},isPublic:{type:Boolean,default:!1},team:{type:Object,default:null},loading:{type:Boolean,default:!1}}});function de(e,n,r,p,h,b){const a=l("matches-table-header"),i=l("matches-table-row"),u=l("app-table");return t(),C(u,{loading:e.loading},{header:_(()=>[d(a)]),body:_(()=>[(t(!0),o(f,null,g(e.matches,s=>(t(),C(i,{match:s,team:e.team,"is-public":e.isPublic,key:s.match_id},null,8,["match","team","is-public"]))),128))]),footer:_(()=>[]),_:1},8,["loading"])}const _e=y(me,[["render",de]]),pe=$({name:"MatchesPage",components:{AppCaption:O,AppButton:x,MatchesTable:_e},data(){return{matches:[],team:null,slice:10,loading:!1,error:!1,ended:!1}},computed:{isPublic(){return this.$route.name==="matches-page"},teamId(){return this.isPublic?0:+this.$route.params.teamId},slicedMatches(){return this.matches.slice(0,this.slice)}},methods:{async getMatches(){try{const{isPublic:e,teamId:n}=this;e?this.matches=await k():this.matches=await H(n)}catch(e){console.error(e)}},async getTeam(){try{if(this.isPublic)return;const e=await B(this.teamId);this.team=e}catch(e){console.error(e)}},onButtonClick(){this.slice+=10}},watch:{slice(e){this.ended=e>=this.matches.length}},async mounted(){try{this.loading=!0,await Promise.allSettled([this.getMatches(),this.getTeam()])}catch(e){console.error(e)}finally{this.loading=!1}}});function he(e,n,r,p,h,b){const a=l("app-caption"),i=l("matches-table"),u=l("app-button");return t(),o(f,null,[d(a,null,{default:_(()=>[T("\u0421\u043F\u0438\u0441\u043E\u043A \u043C\u0430\u0442\u0447\u0435\u0439")]),_:1}),d(i,{matches:e.slicedMatches,team:e.team,"is-public":e.isPublic,loading:e.loading},null,8,["matches","team","is-public","loading"]),e.ended?N("",!0):(t(),C(u,{key:0,class:"button",onClick:e.onButtonClick},{default:_(()=>[T(m(e.error?"\u041E\u0448\u0438\u0431\u043A\u0430":"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0435\u0449\u0435"),1)]),_:1},8,["onClick"]))],64)}const ye=y(pe,[["render",he],["__scopeId","data-v-78f28a06"]]);export{ye as default};
