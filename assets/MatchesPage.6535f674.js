import{g as v}from"./matches.616305e9.js";import{a as A,A as H,b as I,c as B}from"./AppProgress.bbb2365a.js";import{d as y,_ as $,c as o,F as f,h as g,y as k,o as t,i as m,b as c,e as d,w as h,r as l,m as R,t as D,f as P,p as S,g as E,j as C,A as N,s as j}from"./index.50f53e8a.js";import{d as F,H as T,e as w,f as L,a as O,A as V,b as q}from"./AppCaption.6c624786.js";const x=y({name:"MatchesTableHeader",props:{isPublic:{type:Boolean,default:!1}},data(){return{columns:["ID","\u0414\u043B\u0438\u0442\u0435\u043B\u044C\u043D\u043E\u0441\u0442\u044C","Radiant","Dire"]}}});const z=["textContent"];function U(e,n,i,p,_,b){return t(),o("tr",{class:k(["header-row",{"header-row--public":e.isPublic}])},[(t(!0),o(f,null,g(e.columns,a=>(t(),o("th",{key:a,textContent:m(a)},null,8,z))),128))],2)}const G=$(x,[["render",U],["__scopeId","data-v-a0f07260"]]),J=y({name:"MatchesTableRowHeroes",props:{heroes:{type:Array,required:!0}}});const K={class:"heroes-list"},Q=["src","alt"];function W(e,n,i,p,_,b){return t(),o("ul",K,[(t(!0),o(f,null,g(e.heroes,a=>(t(),o("li",{class:"heroes-list__item",key:a.id},[c("img",{src:a.img,alt:a.name},null,8,Q)]))),128))])}const X=$(J,[["render",W],["__scopeId","data-v-ff5bd2b7"]]),Y=y({name:"MatchesTableRow",components:{AppProgress:A,AppTooltip:H,MatchesTableRowHeroes:X},props:{match:{type:Object,required:!0},isPublic:{type:Boolean,default:!1},team:{type:Object,default:null}},computed:{type(){return this.isPublic?F(this.match.avg_rank_tier):this.match.league_name},radiantHeroes(){if(!this.isPublic)return[];const{radiant_team:e}=this.match;return e.split(",").map(n=>{const i=T[n];return{...i,img:`${w}${i.img}`}})},direHeroes(){if(!this.isPublic)return[];const{dire_team:e}=this.match;return e.split(",").map(n=>{const i=T[n];return{...i,img:`${w}${i.img}`}})},duration(){return L(this.match.duration)},ended(){return O(this.match.start_time)},endedDate(){return new Intl.DateTimeFormat("ru",{dateStyle:"long"}).format(this.match.start_time*1e3)},teamName(){return this.team?this.team.name:""},teamLogo(){return this.team?this.team.logo_url:""},teamId(){return this.team?this.team.team_id:0},opposingTeamName(){return this.isPublic?"":this.match.opposing_team_name},opposingTeamLogo(){return this.isPublic?"":this.match.opposing_team_logo},opposingTeamId(){return this.isPublic?0:this.match.opposing_team_id},teams(){if(this.isPublic||!this.team)return[];const{opposing_team_id:e,opposing_team_logo:n,opposing_team_name:i,radiant:p}=this.match,{team_id:_,logo_url:b,name:a}=this.team,r=[],u={name:a,logo:b,id:_},s={name:i,logo:n,id:e};return p?(r[0]=u,r[1]=s):(r[0]=s,r[1]=u),r},teamsHeroes(){return[{id:"radiant",heroes:this.radiantHeroes},{id:"dire",heroes:this.direHeroes}]}}});const Z=e=>(S("data-v-a09b8541"),e=e(),E(),e),ee={class:"table-col"},te=["textContent"],ae=Z(()=>c("span",{class:"table-col__info-separator"},"\xA0/\xA0",-1)),se=["textContent"],oe={class:"table-col"},ne=["textContent"],ie=["src","alt"],re=["textContent"];function ce(e,n,i,p,_,b){const a=l("router-link"),r=l("app-tooltip"),u=l("matches-table-row-heroes");return t(),o("tr",{class:k(["table-row",{"table-row--public":e.isPublic}])},[c("td",ee,[d(a,{class:"table-col__link",to:`/matches/${e.match.match_id}`,textContent:m(e.match.match_id)},null,8,["to","textContent"]),d(r,null,{activator:h(({on:s})=>[c("div",R(D(s,!0),{class:"table-col__info"}),[c("time",{textContent:m(e.ended)},null,8,te),ae,c("span",{textContent:m(e.type)},null,8,se)],16)]),default:h(()=>[P(" "+m(e.endedDate),1)]),_:1})]),c("td",oe,[c("time",{datetime:"",textContent:m(e.duration)},null,8,ne)]),e.isPublic?(t(!0),o(f,{key:0},g(e.teamsHeroes,({heroes:s,id:M})=>(t(),o("td",{class:"table-col",key:M},[d(u,{heroes:s},null,8,["heroes"])]))),128)):(t(!0),o(f,{key:1},g(e.teams,s=>(t(),o("td",{class:"table-col",key:s.id},[d(a,{class:"table-col__team",to:`/teams/${s.id}/matches`},{default:h(()=>[c("img",{class:"table-col__team-logo",src:s.logo,alt:s.name},null,8,ie),c("span",{class:"table-col__team-name",textContent:m(s.name)},null,8,re)]),_:2},1032,["to"])]))),128))],2)}const le=$(Y,[["render",ce],["__scopeId","data-v-a09b8541"]]),ue=y({name:"MatchesTable",components:{AppTable:V,MatchesTableHeader:G,MatchesTableRow:le},props:{matches:{type:Array,required:!0,default:()=>[]},isPublic:{type:Boolean,default:!1},team:{type:Object,default:null},loading:{type:Boolean,default:!1}}});function me(e,n,i,p,_,b){const a=l("matches-table-header"),r=l("matches-table-row"),u=l("app-table");return t(),C(u,{loading:e.loading},{header:h(()=>[d(a,{"is-public":e.isPublic},null,8,["is-public"])]),body:h(()=>[(t(!0),o(f,null,g(e.matches,s=>(t(),C(r,{match:s,team:e.team,"is-public":e.isPublic,key:s.match_id},null,8,["match","team","is-public"]))),128))]),_:1},8,["loading"])}const de=$(ue,[["render",me]]),he=y({name:"MatchesPage",components:{AppCaption:q,AppButton:N,MatchesTable:de},data(){return{matches:[],team:null,slice:10,loading:!1,error:!1,ended:!1}},computed:{isPublic(){return this.$route.name==="matches-page"},teamId(){return this.isPublic?0:+this.$route.params.teamId},slicedMatches(){return this.matches.slice(0,this.slice)}},methods:{async getMatches(){try{const{isPublic:e,teamId:n}=this;e?this.matches=await v():this.matches=await I(n)}catch(e){console.error(e)}},async getTeam(){try{if(this.isPublic)return;const e=await B(this.teamId);this.team=e}catch(e){console.error(e)}},async fetchData(){try{this.loading=!0,await Promise.allSettled([this.getMatches(),this.getTeam()])}catch(e){console.error(e)}finally{this.loading=!1}},onButtonClick(){this.slice+=10}},watch:{slice(e){this.ended=e>=this.matches.length},"$route.fullPath":{immediate:!0,async handler(){this.matches=[],this.team=null,this.slice=10,this.ended=!1,await this.fetchData()}}}});function pe(e,n,i,p,_,b){const a=l("app-caption"),r=l("matches-table"),u=l("app-button");return t(),o(f,null,[d(a,null,{default:h(()=>[P("\u0421\u043F\u0438\u0441\u043E\u043A \u043C\u0430\u0442\u0447\u0435\u0439")]),_:1}),d(r,{matches:e.slicedMatches,team:e.team,"is-public":e.isPublic,loading:e.loading},null,8,["matches","team","is-public","loading"]),e.ended?j("",!0):(t(),C(u,{key:0,class:"button",onClick:e.onButtonClick},{default:h(()=>[P(m(e.error?"\u041E\u0448\u0438\u0431\u043A\u0430":"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0435\u0449\u0435"),1)]),_:1},8,["onClick"]))],64)}const ye=$(he,[["render",pe],["__scopeId","data-v-0dc3683f"]]);export{ye as default};
